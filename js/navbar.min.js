function renderNavbar(basePath=""){
const navbarHTML=`
<nav class="navbar">
  <div class="logo">
    <a href="${basePath}index.html" class="logo-link">
      <img src="${basePath}assets/logo.png" alt="Pixel Phantoms Logo">
      <span>Pixel Phantoms</span>
    </a>
  </div>

  <button class="hamburger" aria-label="Toggle navigation" aria-expanded="false" aria-controls="nav-links">
    <span class="bar"></span>
    <span class="bar"></span>
    <span class="bar"></span>
  </button>

  <ul class="nav-links" id="nav-links">
    <li><a href="${basePath}index.html">Home</a></li>
    <li><a href="${basePath}about.html">About</a></li>
    <li><a href="${basePath}events.html">Events</a></li>
    <li><a href="${basePath}pages/contributors.html">Team</a></li>
    <li><a href="${basePath}pages/login.html">Login</a></li>
    <li><a href="${basePath}contact.html">Contact</a></li>

    <!-- PROFILE ICON -->
    <li class="profile-nav">
      <a href="${basePath}pages/profile.html" aria-label="Profile">
        <i class="fas fa-user-circle profile-icon"></i>
      </a>
    </li>

    <!-- THEME TOGGLE -->
    <li>
      <div class="theme-toggle">
        <input type="checkbox" id="theme-switch" class="theme-switch" aria-label="Toggle theme">
        <label for="theme-switch" class="theme-label">
          <div class="toggle-thumb"></div>
          <span class="sun-icon">‚òÄÔ∏è</span>
          <span class="moon-icon">üåô</span>
        </label>
      </div>
    </li>
  </ul>
</nav>
`;
document.getElementById("navbar-placeholder").innerHTML=navbarHTML;
initMobileMenu();
setActiveNavItem();
}

function setActiveNavItem(){
const currentPage=window.location.pathname.split("/").pop()||"index.html";
const navLinks=document.querySelectorAll(".nav-links a");
navLinks.forEach(function(link){
  link.classList.remove("active");
  const href=link.getAttribute("href");
  if(href){
    const linkPage=href.split("/").pop();
    if(linkPage===currentPage){
      link.classList.add("active");
    }
  }
});
}

function initMobileMenu(){
const container=document.getElementById("navbar-placeholder");
const hamburger=container.querySelector(".hamburger");
const navLinks=container.querySelector(".nav-links");
const body=document.body;
if(!hamburger||!navLinks)return;

function closeMobileMenu(){
  navLinks.classList.remove("open");
  hamburger.classList.remove("open");
  hamburger.setAttribute("aria-expanded","false");
  body.classList.remove("mobile-menu-open");
  body.style.overflow="";
  body.style.position="";
  body.style.width="";
  body.style.height="";
}

function openMobileMenu(){
  navLinks.classList.add("open");
  hamburger.classList.add("open");
  hamburger.setAttribute("aria-expanded","true");
  body.classList.add("mobile-menu-open");
  if(window.innerWidth<=768){
    body.style.overflow="hidden";
    body.style.position="fixed";
    body.style.width="100%";
    body.style.height="100%";
  }
}

hamburger.addEventListener("click",function(e){
  e.stopPropagation();
  const isExpanded=this.getAttribute("aria-expanded")==="true";
  if(isExpanded){closeMobileMenu();}else{openMobileMenu();}
});

container.querySelectorAll(".nav-links a").forEach(function(link){
  link.addEventListener("click",function(){closeMobileMenu();});
});

document.addEventListener("click",function(e){
  if(navLinks.classList.contains("open")&&!navLinks.contains(e.target)&&!hamburger.contains(e.target)){
    closeMobileMenu();
  }
});

document.addEventListener("keydown",function(e){
  if(e.key==="Escape"&&navLinks.classList.contains("open")){
    closeMobileMenu();
  }
});

let lastScrollTop=0;
window.addEventListener("scroll",function(){
  if(navLinks.classList.contains("open")){
    const scrollTop=window.pageYOffset||document.documentElement.scrollTop;
    if(Math.abs(scrollTop-lastScrollTop)>50){
      closeMobileMenu();
    }
    lastScrollTop=scrollTop;
  }
});

window.addEventListener("resize",function(){
  if(window.innerWidth>768){
    closeMobileMenu();
  }
});

let touchStartY=0;
let touchEndY=0;

document.addEventListener("touchstart",function(e){
  touchStartY=e.changedTouches[0].screenY;
},{passive:true});

document.addEventListener("touchend",function(e){
  touchEndY=e.changedTouches[0].screenY;
  if(navLinks.classList.contains("open")&&Math.abs(touchEndY-touchStartY)>30){
    closeMobileMenu();
  }
},{passive:true});

console.log("Navbar initialized with profile icon");
}

if(typeof module!=="undefined"&&module.exports){
module.exports={renderNavbar,initMobileMenu};
}
